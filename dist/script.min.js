function OrderCloudSDKBuyerXP(e){e.decorator("OrderCloudSDK",["$delegate","bachBuyerXp","$q",function(e,n,r){return e.Buyers.Get=function(){var r=e.GetToken();return n.Get(r)},e.Buyers.Update=function(){var t=[].slice.call(arguments)[1],o=e.GetToken();return t&&t.xp?n.Update(o,t.xp):r.reject("Missing body")},e.Buyers.Patch=function(){var t=[].slice.call(arguments)[1],o=e.GetToken();return t?n.Patch(o,t):r.reject("Missing body")},e}])}function OrderCloudSDKAnonAdditions(e){e.decorator("OrderCloudSDK",["$delegate","$cookies","ocAppName",function(e,n,r){var t=r.Watch().replace(/ /g,"_").toLowerCase(),o=t+"anonymous.token",a=t+"impersonate.token",c=t+"admin.token";e.GetAnonToken=function(){return n.get(o)},e.SetAnonToken=function(e){n.put(o,e)},e.GetImpersonationToken=function(){return n.get(a)},e.SetImpersonationToken=function(e){n.put(a,e)},e.GetAdminToken=function(){return n.get(c)},e.SetAdminToken=function(e){n.put(c,e)},e.RemoveAdminToken=function(){n.remove(c)};var u=e.As;return e.As=function(){var n=e.GetImpersonationToken();return u(n)},e.AsAnon=function(){var n=e.GetAnonToken();return u(n)},e.AsAdmin=function(){var n=e.GetAdminToken();return u(n)},e}])}function bachBuyerXpService(e,n,r,t){function o(t){function o(){var e=r(function(){i&&(r.cancel(e),a.resolve(i))},100)}var a=e.defer();return i?a.resolve(i):d?o():(d=!0,n.get(u,{headers:{"oc-token":t}}).then(function(e){i={xp:e.data},a.resolve(i)}).catch(function(e){a.reject(e)})),a.promise}function a(e,r){return n.put(u,r,{headers:{"oc-token":e}})}function c(e,r){return n.patch(u,e,{headers:{"oc-token":r}})}var u=t+"/buyerxp",i=null,d=!1,s={Get:o,Update:a,Patch:c};return s}function bachGiftCards(e,n,r,t,o,a){function c(e){return m().create(e).$promise}function u(e){return e.body||e.body.id?m().update({id:e.body.id},e.body).$promise:o.error("id is a required parameter")}function i(e){return m().delete({id:e.id}).$promise}function d(e){return m().list(e&&e.searchTerm?{searchTerm:e.searchTerm}:null).$promise.then(function(e){return e.list})}function s(n){return a.post(e+"/giftcards/purchase/"+n.orderid,{},{headers:{"oc-token":f()}})}function m(){var r={create:{method:"POST"},update:{method:"PUT"},"delete":{method:"DELETE"},list:{method:"GET"}};return _.each(r,function(e){e.headers={"oc-token":f()}}),n(e+"/giftcards/:id",{},r)}function f(){var e=t.Watch().replace(/ /g,"_").toLowerCase(),n=e+".token";return r.get(n)}var l={Create:c,Update:u,Delete:i,List:d,Purchase:s};return l}angular.module("bachmans-common",[]),angular.module("bachmans-common").config(OrderCloudSDKBuyerXP),OrderCloudSDKBuyerXP.$inject=["$provide"],angular.module("bachmans-common").config(OrderCloudSDKAnonAdditions),OrderCloudSDKAnonAdditions.$inject=["$provide"],angular.module("bachmans-common").factory("bachBuyerXp",bachBuyerXpService),bachBuyerXpService.$inject=["$q","$http","$interval","nodeapiurl"],angular.module("bachmans-common").factory("bachGiftCards",bachGiftCards),bachGiftCards.$inject=["nodeapiurl","$resource","$cookies","ocAppName","toastr","$http"];